# EC2 Kubernetes Cluster Terraform Project

## Introduction

This project demonstrates how to use Terraform to provision AWS EC2 instances that will be used to build a Kubernetes cluster from scratch. The project takes a comprehensive approach to Kubernetes deployment, covering both infrastructure provisioning and cluster configuration.

### Project Purpose

The primary goal of this project is to:

1. **Infrastructure as Code**: Use Terraform to automatically provision AWS EC2 instances with proper networking, security groups, and SSH key management
2. **Kubernetes "The Hard Way"**: Implement a complete Kubernetes cluster setup following Kelsey Hightower's "Kubernetes The Hard Way" methodology
3. **Learning Experience**: Provide hands-on experience with both Terraform and Kubernetes cluster administration
4. **Production-Ready Foundation**: Create a solid foundation that can be extended for production use cases

### Architecture Overview

The project creates a multi-node Kubernetes cluster consisting of:

- **Jumpbox**: Administration machine for running cluster setup commands
- **Control Plane (server)**: Hosts the Kubernetes API server, etcd, scheduler, and controller manager
- **Worker Nodes (node-0, node-1)**: Run containerized applications and workloads

### What You'll Learn

Through this project, you'll gain experience with:

- Terraform infrastructure provisioning
- AWS EC2 instance management
- Kubernetes cluster bootstrapping
- TLS certificate management
- Container runtime configuration (containerd)
- CNI networking setup
- RBAC and security configurations
- Pod networking and routing

This Terraform project deploys EC2 instances in the AWS free tier using the default VPC and subnet, then provides step-by-step instructions for building a production-ready Kubernetes cluster.

## Prerequisites

1. **Terraform CLI** (version >= 1.0)
   - Download from: https://www.terraform.io/downloads
   - Or install via package manager:
     - Windows: `choco install terraform`
     - macOS: `brew install terraform`
     - Linux: `sudo apt-get install terraform` (Ubuntu/Debian)

2. **AWS CLI** (version 2.x recommended)
   - Download from: https://aws.amazon.com/cli/
   - Or install via package manager:
     - Windows: `choco install awscli` or `winget install Amazon.AWSCLI`
     - macOS: `brew install awscli`
     - Linux: `sudo apt-get install awscli` (Ubuntu/Debian)

3. **AWS Account** with appropriate permissions
   - EC2, VPC, and IAM permissions
   - Configure credentials: `aws configure`

4. **SSH Key Pair** (automatically generated by Terraform)
   - No manual setup required - Terraform will create the key pair

## Project Structure

```
.
├── main.tf          # Main Terraform configuration
├── variables.tf     # Variable definitions
├── outputs.tf       # Output values
├── README.md        # This file
└── ssh/             # SSH keys directory
    ├── main-key     # Private key
    └── main-key.pub # Public key
```

## Features

- **Free Tier Eligible**: Uses `t2.micro` instance type
- **Default VPC**: Uses AWS default VPC and subnet
- **Security Group**: Allows SSH (22), HTTP (80), and HTTPS (443) access
- **Web Server**: Automatically installs and starts Apache HTTP server
- **Public IP**: Instance gets a public IP address for external access

## Usage

### 1. Initialize Terraform

```bash
terraform init
```

### 2. Plan the deployment

```bash
terraform plan
```

### 3. Apply the configuration

```bash
terraform apply
```

### 4. Access the instance

After deployment, you can:

- **SSH into the instance**:

  ```bash
  ssh -i ssh/main-key ec2-user@<public_ip>
  ```

- **Access the web server**:
  Open `http://<public_ip>` in your browser

### 5. Destroy the infrastructure

```bash
terraform destroy
```

## Outputs

After successful deployment, Terraform will output:

- `public_ip`: Public IP address of the EC2 instance
- `instance_id`: AWS instance ID
- `instance_arn`: AWS resource ARN
- `availability_zone`: Availability zone where the instance is deployed

## Security Notes

- The security group allows SSH access from anywhere (0.0.0.0/0)
- Consider restricting SSH access to your IP address for production use
- The private key file (`ssh/main-key`) should be kept secure and not committed to version control

## Free Tier Considerations

- **t2.micro** instances are eligible for AWS free tier
- Free tier includes 750 hours per month of t2.micro usage
- Monitor your usage in the AWS Billing Console
- Remember to destroy resources when not in use to avoid charges
